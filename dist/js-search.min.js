"use strict";var JsSearch;!function(e){var t=function(){function e(){}return e.prototype.expandToken=function(e){for(var t=[],n=0,r=e.length;r>n;++n)for(var i="",o=n;r>o;++o)i+=e.charAt(o),t.push(i);return t},e}();e.AllSubstringsIndexStrategy=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(){}return e.prototype.expandToken=function(e){return e?[e]:[]},e}();e.ExactWordIndexStrategy=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(){}return e.prototype.expandToken=function(e){for(var t=[],n="",r=0,i=e.length;i>r;++r)n+=e.charAt(r),t.push(n);return t},e}();e.PrefixIndexStrategy=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(){}return e.prototype.sanitize=function(e){return e?e.trim():""},e}();e.CaseSensitiveSanitizer=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(){}return e.prototype.sanitize=function(e){return e?e.toLocaleLowerCase().trim():""},e}();e.LowerCaseSanitizer=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){}(JsSearch||(JsSearch={}));var JsSearch;!function(e){}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(e){this.uidFieldName_=e,this.tokenToIdfCache_={},this.tokenMap_={}}return e.prototype.indexDocument=function(e,t,n){this.tokenToIdfCache_={},this.tokenMap_[e]?this.tokenMap_[e].$totalNumOccurrences++:this.tokenMap_[e]={$numDocumentOccurrences:0,$totalNumOccurrences:1,$uidMap:{}},this.tokenMap_[e].$uidMap[t]?this.tokenMap_[e].$uidMap[t].$numTokenOccurrences++:(this.tokenMap_[e].$numDocumentOccurrences++,this.tokenMap_[e].$uidMap[t]={$document:n,$numTokenOccurrences:1})},e.prototype.search=function(e,t){for(var n={},r=0,i=e.length;i>r;r++){var o=e[r],a=this.tokenMap_[o];if(!a)return[];if(0===r)for(var s in a.$uidMap)n[s]=a.$uidMap[s].$document;else for(var s in n)a.$uidMap[s]||delete n[s]}var h=[];for(var s in n)h.push(n[s]);return h.sort(function(n,r){return this.calculateTfIdf_(e,r,t)-this.calculateTfIdf_(e,n,t)}.bind(this))},e.prototype.calculateIdf_=function(e,t){if(!this.tokenToIdfCache_[e]){var n=this.tokenMap_[e]&&this.tokenMap_[e].$numDocumentOccurrences||0;this.tokenToIdfCache_[e]=1+Math.log(t.length/(1+n))}return this.tokenToIdfCache_[e]},e.prototype.calculateTfIdf_=function(e,t,n){for(var r=0,i=0,o=e.length;o>i;++i){var a=e[i],s=this.calculateIdf_(a,n);s===1/0&&(s=0);var h=t&&t[this.uidFieldName_],c=this.tokenMap_[a]&&this.tokenMap_[a].$uidMap[h]&&this.tokenMap_[a].$uidMap[h].$numTokenOccurrences||0;r+=c*s}return r},e}();e.TfIdfSearchIndex=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(){this.tokenToUidToDocumentMap_={}}return e.prototype.indexDocument=function(e,t,n){this.tokenToUidToDocumentMap_[e]||(this.tokenToUidToDocumentMap_[e]={}),this.tokenToUidToDocumentMap_[e][t]=n},e.prototype.search=function(e,t){for(var n={},r=0,i=e.length;i>r;r++){var o=e[r],a=this.tokenToUidToDocumentMap_[o]||{};if(0===r)for(var s in a)n[s]=a[s];else for(var s in n)a[s]||delete n[s]}var h=[];for(var s in n)h.push(n[s]);return h},e}();e.UnorderedSearchIndex=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function t(t){this.uidFieldName_=t,this.indexStrategy_=new e.PrefixIndexStrategy,this.searchIndex_=new e.TfIdfSearchIndex(t),this.sanitizer_=new e.LowerCaseSanitizer,this.tokenizer_=new e.SimpleTokenizer,this.documents_=[],this.searchableFieldsMap_={}}return Object.defineProperty(t.prototype,"indexStrategy",{get:function(){return this.indexStrategy_},set:function(e){if(this.initialized_)throw Error("IIndexStrategy cannot be set after initialization");this.indexStrategy_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sanitizer",{get:function(){return this.sanitizer_},set:function(e){if(this.initialized_)throw Error("ISanitizer cannot be set after initialization");this.sanitizer_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchIndex",{get:function(){return this.searchIndex_},set:function(e){if(this.initialized_)throw Error("ISearchIndex cannot be set after initialization");this.searchIndex_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tokenizer",{get:function(){return this.tokenizer_},set:function(e){if(this.initialized_)throw Error("ITokenizer cannot be set after initialization");this.tokenizer_=e},enumerable:!0,configurable:!0}),t.prototype.addDocument=function(e){this.addDocuments([e])},t.prototype.addDocuments=function(e){this.documents_.push.apply(this.documents_,e),this.indexDocuments_(e,Object.keys(this.searchableFieldsMap_))},t.prototype.addIndex=function(e){this.searchableFieldsMap_[e]=!0,this.indexDocuments_(this.documents_,[e])},t.prototype.search=function(e){var t=this.tokenizer_.tokenize(this.sanitizer_.sanitize(e));return this.searchIndex_.search(t,this.documents_)},t.prototype.indexDocuments_=function(e,t){this.initialized_=!0;for(var n=0,r=e.length;r>n;n++)for(var i=e[n],o=i[this.uidFieldName_],a=0,s=t.length;s>a;a++){var h=t[a],c=this.getValue(i,h);if("string"==typeof c)for(var u=this.tokenizer_.tokenize(this.sanitizer_.sanitize(c)),f=0,d=u.length;d>f;f++)for(var p=u[f],l=this.indexStrategy_.expandToken(p),m=0,_=l.length;_>m;m++){var S=l[m];this.searchIndex_.indexDocument(S,o,i)}}},t.prototype.getValue=function(e,t){if(t=t||"",e=e||{},t.indexOf(".")<0)return e[t];for(var n=t.split("."),r=e,i=0;i<n.length;i++)if(r=r[n[i]],!r)return e[t];return r},t}();e.Search=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){e.StopWordsMap={a:"a",able:"able",about:"about",across:"across",after:"after",all:"all",almost:"almost",also:"also",am:"am",among:"among",an:"an",and:"and",any:"any",are:"are",as:"as",at:"at",be:"be",because:"because",been:"been",but:"but",by:"by",can:"can",cannot:"cannot",could:"could",dear:"dear",did:"did","do":"do",does:"does",either:"either","else":"else",ever:"ever",every:"every","for":"for",from:"from",get:"get",got:"got",had:"had",has:"has",have:"have",he:"he",her:"her",hers:"hers",him:"him",his:"his",how:"how",however:"however",i:"i","if":"if","in":"in",into:"into",is:"is",it:"it",its:"its",just:"just",least:"least",let:"let",like:"like",likely:"likely",may:"may",me:"me",might:"might",most:"most",must:"must",my:"my",neither:"neither",no:"no",nor:"nor",not:"not",of:"of",off:"off",often:"often",on:"on",only:"only",or:"or",other:"other",our:"our",own:"own",rather:"rather",said:"said",say:"say",says:"says",she:"she",should:"should",since:"since",so:"so",some:"some",than:"than",that:"that",the:"the",their:"their",them:"them",then:"then",there:"there",these:"these",they:"they","this":"this",tis:"tis",to:"to",too:"too",twas:"twas",us:"us",wants:"wants",was:"was",we:"we",were:"were",what:"what",when:"when",where:"where",which:"which","while":"while",who:"who",whom:"whom",why:"why",will:"will","with":"with",would:"would",yet:"yet",you:"you",your:"your"}}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function t(t,n,r){this.indexStrategy_=t||new e.PrefixIndexStrategy,this.sanitizer_=n||new e.LowerCaseSanitizer,this.wrapperTagName_=r||"mark"}return t.prototype.highlight=function(e,t){for(var n=this.wrapText_("").length,r={},i=0,o=t.length;o>i;i++)for(var a=this.sanitizer_.sanitize(t[i]),s=this.indexStrategy_.expandToken(a),h=0,c=s.length;c>h;h++){var u=s[h];r[u]?r[u].push(a):r[u]=[a]}for(var f="",d="",p=0,i=0,l=e.length;l>i;i++){var m=e.charAt(i);" "===m?(f="",d="",p=i+1):(f+=m,d+=this.sanitizer_.sanitize(m)),r[d]&&r[d].indexOf(d)>=0&&(f=this.wrapText_(f),e=e.substring(0,p)+f+e.substring(i+1),i+=n,l+=n)}return e},t.prototype.wrapText_=function(e){return"<"+this.wrapperTagName_+">"+e+"</"+this.wrapperTagName_+">"},t}();e.TokenHighlighter=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(){}return e.prototype.tokenize=function(e){return e.split(/[^a-zA-Z0-9\-']+/).filter(function(e){return!!e})},e}();e.SimpleTokenizer=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function e(e,t){this.stemmingFunction_=e,this.tokenizer_=t}return e.prototype.tokenize=function(e){return this.tokenizer_.tokenize(e).map(function(e){return this.stemmingFunction_(e)},this)},e}();e.StemmingTokenizer=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){var t=function(){function t(e){this.tokenizer_=e}return t.prototype.tokenize=function(t){return this.tokenizer_.tokenize(t).filter(function(t){return t&&e.StopWordsMap[t]!==t})},t}();e.StopWordsTokenizer=t}(JsSearch||(JsSearch={}));var JsSearch;!function(e){}(JsSearch||(JsSearch={})),function(e){"undefined"!=typeof module&&module.exports&&e&&(module.exports=e)}(JsSearch||(JsSearch={}));